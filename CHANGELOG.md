# 更新日志

本文档记录 OfficeGuard / 系统优化助手 的所有版本更新。

## [2.0.0] - 2025-12-19

### 🎉 重大更新 - 全新架构重构

#### 🏗️ 架构重构
- ✨ 完全重写代码架构，从单文件改为模块化结构
- ✨ 新增 `src/` 目录，分离 UI、核心逻辑、工具模块
- ✨ 采用现代化 MVC 架构，提高可维护性
- ✨ 统一的主题系统和组件库

#### 🎨 全新 UI 设计
- ✨ 参考 shadcn/ui 设计语言，简洁现代风格
- ✨ 全新的卡片式布局和圆角设计
- ✨ 统一的配色方案和字体系统
- ✨ 响应式布局，支持窗口缩放
- ✨ 所有页面支持鼠标滚轮滚动

#### 📱 四大功能页面
- **定时任务**: 圆形进度条，可视化倒计时
- **系统锁定**: 密码保护，安全锁屏
- **设置中心**: 快捷键、自动登录、启动软件管理
- **关于页面**: 版本信息和帮助链接

#### 🔧 组件化 UI
- ✨ ModernButton: 支持多种变体 (primary/outline/ghost/danger)
- ✨ ModernEntry: 带边框动画的输入框
- ✨ ModernCheckbox: 现代复选框
- ✨ Card: 卡片容器组件
- ✨ CircularProgress: 圆形进度条
- ✨ LabeledSwitch: 带标签的开关
- ✨ ScrollableFrame: 可滚动容器

#### 🖥️ 4K 高 DPI 支持
- ✨ 自动适配系统 DPI 缩放
- ✨ 优化字体大小适配高分辨率屏幕
- ✨ 支持 200% 缩放显示

### 🛠️ 技术改进
- 🚀 Python 3.14 兼容性支持
- 🚀 优化按钮悬浮效果，避免抖动
- 🚀 统一的错误处理和日志记录
- 🚀 模块化的配置管理

### 📁 新项目结构
```
OfficeGuard/
├── main.py                 # 程序入口
├── src/
│   ├── core/              # 核心功能模块
│   │   ├── config.py      # 配置管理
│   │   ├── timer.py       # 定时任务
│   │   ├── lock.py        # 系统锁定
│   │   ├── hotkey.py      # 快捷键
│   │   └── tray.py        # 系统托盘
│   ├── ui/                # 用户界面
│   │   ├── app.py         # 主应用
│   │   ├── theme.py       # 主题系统
│   │   ├── components/    # UI 组件
│   │   └── pages/         # 功能页面
│   └── utils/             # 工具模块
├── docs/                  # 文档目录
│   └── archive/           # 归档文档
└── requirements.txt
```

---

## [1.3.0] - 2025-12-18

### 🎉 重大新增

#### 🚀 开机自启动系统
- ✨ 开机自动启动程序功能
- ✨ 智能判断系统开机（非睡眠唤醒）
- ✨ 开机自动执行任务

#### 🔐 Sysinternals Autologon 集成
- ✨ 使用微软官方Autologon工具
- ✨ LSA加密存储登录密码（替代明文注册表）
- ✨ 自动下载并封装Autologon.exe
- ✨ 支持本机账户和域账户
- ✨ 安全性大幅提升

#### 📦 启动软件管理器
- ✨ 可视化管理开机启动软件列表
- ✨ 支持添加/编辑/删除启动项
- ✨ 单独启用/禁用单个软件
- ✨ 文件浏览器选择.exe文件
- ✨ 自定义启动软件名称和路径

#### 🔒 配置文件加密
- ✨ 使用Windows DPAPI加密配置文件
- ✨ 用户绑定：只有当前用户可解密
- ✨ 机器绑定：无法在其他电脑解密
- ✨ AES-256加密算法
- ✨ 自动向后兼容旧配置文件

### 🛠️ 优化改进
- 🚀 设置界面添加滚动支持
- 🚀 增强错误提示和用户引导
- 🚀 优化配置保存和加载逻辑
- 🚀 完善日志记录机制

### 🔒 安全性提升
- 🔑 配置文件加密保护敏感信息
- 🔑 自动登录密码LSA加密存储
- 🔑 放弃不安全的明文注册表存储

### 📝 配置文件格式
新增配置项：
```json
{
  "autostart_enabled": false,
  "autologon_enabled": false,
  "autologon_username": "",
  "autologon_password": "",
  "autologon_domain": ".",
  "startup_apps": []
}
```

### 💾 文件结构
- 📁 新增：`%LOCALAPPDATA%\OfficeGuard\tools\` - 工具目录
- 📁 自动下载：Autologon.exe (约200KB)

---

## [1.2.0] - 2025-12-18

### 恢复
- ✨ 恢复定时关机功能
- ✨ 恢复定时睡眠功能
- ✨ 完整的定时任务标签页

### 新增
- ✨ 快捷键完全自定义功能
- ✨ 设置标签页：快捷键配置界面
- ✨ 支持自定义修饰键（Ctrl/Alt/Shift）
- ✨ 支持字母键（A-Z）和功能键（F1-F12）
- ✨ 实时预览快捷键组合
- ✨ 快捷键保存和热重载

### 优化
- 🚀 三标签页布局：定时任务、系统优化、设置
- 🚀 快捷键显示动态更新
- 🚀 更直观的设置界面

### 修复
- 🐛 修复快捷键硬编码问题
- 🐛 优化快捷键检测逻辑

---

## [1.1.0] - 2025-12-18

### 新增
- ✨ 系统托盘功能：程序默认隐藏到托盘运行
- ✨ 全局快捷键：Ctrl+Alt+L 系统级快速优化
- ✨ 托盘菜单：进入、快捷键开关、关闭三大功能
- ✨ 快捷键开关：可通过托盘菜单启用/禁用快捷键

### 优化
- 🚀 精简UI界面，移除定时任务标签页
- 🚀 迷惑性表述：所有文本改为系统优化相关
- 🚀 静默恢复：优化完成后不再弹出提示窗口
- 🚀 窗口管理：关闭窗口改为隐藏到托盘
- 🚀 启动逻辑：程序启动后自动隐藏

### 修复
- 🐛 修复窗口关闭直接退出的问题
- 🐛 优化托盘图标显示效果

### 技术
- 🔧 新增依赖：pystray, Pillow
- 🔧 重构窗口管理逻辑
- 🔧 实现全局Hook快捷键

---

## [1.0.1] - 2025-12-10

### 新增
- ✨ UI 自动重置功能：执行完定时任务后，UI 自动恢复初始状态
- ✨ 密码显示/隐藏切换：密码输入框支持星号隐藏，新增眼睛按钮切换显示/隐藏

### 优化
- 🚀 改善用户体验，执行后 UI 更清爽
- 🚀 提高密码输入安全性，默认隐藏密码显示

### 修复
- 🐛 修复执行完操作后 UI 状态混乱的问题

---

## [1.0.0] - 2025-12-10

### 新增
- ✨ 首次运行引导界面，友好的用户体验
- ✨ 完整的日志记录系统，支持日志轮转（5MB x 4份）
- ✨ 数据自动保存到 AppData 目录
- ✨ 支持打包为独立 exe，无需 Python 环境
- ✨ 定时关机/睡眠功能
- ✨ 系统锁定功能（内核级键鼠屏蔽）
- ✨ 智能缓冲期，移动鼠标取消任务
- ✨ 窗口位置和大小自动记忆

### 优化
- 🚀 优化 exe 打包适配，完美支持 PyInstaller
- 🚀 改进关机任务安全退出机制
- 🚀 优化鼠标困禁逻辑，降低 CPU 占用
- 🚀 增强键盘输入识别（支持主键盘和小键盘）
- 🚀 改进异常处理和错误日志记录
- 🚀 优化焦点循环频率，降低资源占用

### 修复
- 🐛 修复配置文件保存失败问题
- 🐛 修复窗口位置记忆不准确问题
- 🐛 修复多个钩子卸载异常
- 🐛 修复定时器取消不彻底问题
- 🐛 修复鼠标移动检测灵敏度问题

### 文档
- 📝 完善 README 文档
- 📝 添加构建指南
- 📝 添加贡献指南
- 📝 添加中英文双语文档

---

## 版本说明

版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范：

- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

## 图例

- ✨ 新增功能
- 🚀 性能优化
- 🐛 Bug 修复
- 📝 文档更新
- 🔧 配置变更
- ⚠️ 重要提示
