# 系统优化助手 v1.2.0 发布说明

发布日期：2025-12-18

## 🎯 本次更新重点

根据用户反馈，本版本**恢复了定时任务功能**并**开放了快捷键自定义**，让软件更加灵活实用。

## ✨ 恢复功能

### 1. 定时关机/睡眠
- ✅ **完整恢复定时任务标签页**
- ✅ 定时关机功能
- ✅ 定时睡眠功能
- ✅ 智能缓冲期（移动鼠标取消）
- ✅ 实时倒计时显示
- ✅ 进度条显示

**使用场景：**
- 下班前设置定时关机
- 下载完成后自动睡眠
- 定时提醒休息

## 🆕 全新功能

### 1. 快捷键完全自定义

之前版本快捷键固定为 `Ctrl+Alt+L`，现在可以完全自定义！

**设置界面：**
- 📝 新增"设置"标签页
- ✅ 勾选修饰键：Ctrl / Alt / Shift
- ✅ 输入主键：A-Z 或 F1-F12
- 👀 实时预览快捷键组合
- 💾 一键保存并应用

**支持的按键：**
- **修饰键**：Ctrl、Alt、Shift（可任意组合）
- **主键**：A-Z 字母键、F1-F12 功能键

**示例组合：**
```
Ctrl+Shift+O
Alt+F1
Ctrl+Alt+Shift+P
仅 F12（不需要修饰键）
```

### 2. 设置标签页

全新的设置界面，包含：
- 快捷键自定义
- 快捷键开关
- 实时预览
- 使用提示

## 🎨 界面改进

### 三标签页布局
```
⏱️ 定时任务    🛡️ 系统优化    ⚙️ 设置
```

**定时任务页：**
- 倒计时设置
- 缓冲时间设置
- 启动关机/睡眠按钮
- 实时状态显示

**系统优化页：**
- 密码设置
- 当前快捷键显示
- 立即优化按钮

**设置页：**
- 快捷键自定义
- 配置保存
- 使用说明

## 📝 配置更新

### 新增配置项
```json
{
  "hotkey_ctrl": true,      // 是否需要Ctrl
  "hotkey_alt": true,       // 是否需要Alt
  "hotkey_shift": false,    // 是否需要Shift
  "hotkey_key": "L"         // 主键（A-Z或F1-F12）
}
```

### 完整配置示例
```json
{
  "password": "000",
  "timer_minutes": 60,
  "grace_seconds": 30,
  "mouse_threshold": 15,
  "win_w": 780,
  "win_h": 600,
  "win_x": -1,
  "win_y": -1,
  "first_run": false,
  "hotkey_enabled": true,
  "hotkey_ctrl": true,
  "hotkey_alt": true,
  "hotkey_shift": false,
  "hotkey_key": "L"
}
```

## 🔧 使用指南

### 定时任务

#### 设置定时关机
1. 切换到"定时任务"标签页
2. 设置倒计时（分钟）
3. 设置缓冲时间（秒）
4. 点击"启动关机"
5. 倒计时结束前移动鼠标可取消

#### 设置定时睡眠
步骤同上，点击"启动睡眠"即可

### 自定义快捷键

#### 方式一：使用界面
1. 切换到"设置"标签页
2. 选择修饰键（Ctrl/Alt/Shift）
3. 输入主键（如 O、F1 等）
4. 查看实时预览
5. 点击"保存快捷键设置"

#### 方式二：直接修改配置
编辑配置文件：
```
C:\Users\{用户}\AppData\Local\OfficeGuard\config\guard_config.json
```

修改相关字段后重启程序。

### 快捷键示例

**推荐组合：**
- `Ctrl+Alt+L` - 默认（不易冲突）
- `Ctrl+Shift+O` - 优化（Optimize）
- `Alt+F12` - 功能键组合
- `Ctrl+Alt+P` - 性能（Performance）

**避免的组合：**
- `Ctrl+C` / `Ctrl+V` - 系统常用
- `Alt+F4` - 关闭窗口
- `Ctrl+Alt+Del` - 系统保留

## ⚠️ 重要提示

### 快捷键冲突
- 如果快捷键与其他软件冲突，请更换组合
- 建议使用至少一个修饰键
- 功能键（F1-F12）冲突较少

### 定时任务
- 关闭程序会自动取消任务
- 缓冲期内可移动鼠标取消
- 系统睡眠/休眠会中断任务

### 升级须知
- 从 v1.1.0 升级无需卸载
- 配置文件自动兼容
- 快捷键设置保留默认值

## 🐛 已知问题

1. **快捷键限制**
   - 部分全屏游戏中可能无效
   - 某些安全软件可能拦截

2. **定时任务**
   - 系统睡眠会中断任务
   - 关机前需要保存工作

## 🎯 使用场景

### 场景1：下班定时关机
```
1. 设置倒计时：30分钟
2. 设置缓冲：30秒
3. 点击"启动关机"
4. 下班走人，30分钟后自动关机
```

### 场景2：快速优化（自定义快捷键）
```
1. 进入设置页
2. 设置快捷键为 Ctrl+Shift+O
3. 保存设置
4. 随时按 Ctrl+Shift+O 快速优化
```

### 场景3：下载完成后睡眠
```
1. 开始下载
2. 估算完成时间
3. 设置定时睡眠
4. 下载完成自动进入睡眠
```

## 📊 版本对比

| 功能 | v1.1.0 | v1.2.0 |
|------|--------|--------|
| 定时关机 | ❌ | ✅ |
| 定时睡眠 | ❌ | ✅ |
| 系统优化 | ✅ | ✅ |
| 系统托盘 | ✅ | ✅ |
| 固定快捷键 | Ctrl+Alt+L | - |
| 自定义快捷键 | ❌ | ✅ |
| 标签页数量 | 1 | 3 |

## 🔮 后续计划

### v1.3.0
- [ ] 快捷键冲突检测
- [ ] 定时任务预设方案
- [ ] 更多主题选项
- [ ] 开机自启动

### v1.4.0
- [ ] 定时任务历史记录
- [ ] 快捷键热切换
- [ ] 多密码支持
- [ ] 云端配置同步

## 📖 相关文档

- [快速开始](QUICK_START.md)
- [完整说明](README_zh.md)
- [更新日志](CHANGELOG.md)
- [开发文档](DEV_NOTES.md)

## 📧 反馈与支持

遇到问题？
1. 查看日志：`C:\Users\{用户}\AppData\Local\OfficeGuard\logs\guard.log`
2. 提交 Issue：[GitHub Issues](https://github.com/xqy272/OfficeGuard/issues)
3. 查看文档：项目 README

---

**感谢支持，祝使用愉快！** 🎉
